% Chapter 4
\chapter{تعویض مدل‌های شبکه عصبی بین کاربران}

\section{مقدمه}
در فصل پیشین، روش‌های متعددی برای حل مشکل داده‌های
\lr{non-IID}
مورد بررسی قرار گرفتند. در این فصل، رویکرد جامعی برای مقابله با این چالش، یعنی تبادل مدل‌های شبکه عصبی میان کاربران نهایی، بررسی می‌شود که محور اصلی این پایان‌نامه را تشکیل می‌دهد. به منظور درک بهتر، ابتدا یک مثال از داده‌های
\lr{non-IID}
مطرح خواهد شد.

فرض کنید هدف، آموزش مدلی برای تشخیص اشیا مانند علائم ترافیکی و علائم فروشگاهی است. اگر وسایل نقلیه به ترتیب در بزرگراه و مرکز شهر حرکت کنند، داده‌های ویدیویی آن‌ها توزیع‌های متفاوتی از این علائم خواهند داشت. به این معنا که داده‌های آموزشی جمع‌آوری شده از بزرگراه ممکن است کمتر شامل علائم فروشگاهی باشند، در حالی که داده‌های جمع‌آوری شده از مرکز شهر حاوی تعداد بیشتری از هر دو نوع علائم خواهند بود. این تفاوت در توزیع داده‌ها در دستگاه‌های نهایی می‌تواند باعث ایجاد مشکل انحراف وزن‌ها شود.

برای حل این مسئله، عملیات تعویض مدل‌های شبکه عصبی بین کاربران نهایی پیشنهاد می‌شود. این رویکرد، مدل‌ها را بین دستگاه‌های نهایی جابجا می‌کند تا تنوع داده‌ها در دستگاه‌های مختلف کاهش یابد. این عملیات بدون نیاز به هزینه‌های محاسباتی و ارتباطی اضافی، به بهبود عملکرد مدل در مواجهه با داده‌های
\lr{non-IID}
کمک می‌کند.

در این فصل ابتدا ...

\section{
	روش تعویض فدرال%
\LTRfootnote{Federated Swapping}
}
در این روش، یک عملیات جدید به نام تعویض فدرال یا
\lr{FedSwap}
پیشنهاد شده است که جایگزین برخی از دوره‌های
\lr{FedAvg}
در سرور می‌شود. اصل اساسی
\lr{FedSwap}
این است که به جای اجرای
\lr{FedAvg}
در هر تکرار، به دستگاه‌های نهایی اجازه می‌دهد تا مدل‌های محلی خود را در سرور با یکدیگر تبادل کنند. برای حفظ عدالت، از یک استراتژی چرخشی استفاده می‌شود تا هر دو دستگاه نهایی بتوانند عملیات تعویض مدل را انجام دهند. علاوه بر این، انتظار می‌رود که این عملیات تعویض مدل بین دستگاه‌های نهایی، به هر مدل دید گسترده‌تری از کل مجموعه داده‌ها بدهد و در نتیجه، انحراف وزن‌ها را کاهش دهد.

\subsection{FedAvgCode}
تست در الگوریتم
\ref{algo_fedswap}
تست


\begin{LTR}
\SetAlgoNlRelativeSize{-1}
\begin{algorithm}[t]
	\begin{RTL}
	\caption{%
		تعویض فدرال
		\lr{(FedSwap)}
		\cite{elbir2022family}
	}
	\label{algo_fedswap}
	\end{RTL}
	
	\begin{latin}
	Initialize all clients model with weight $w_0$\;
	\For{$t = 1, 2, \ldots, T$}{
		\For{each client $c = 1, 2, \ldots, C$
			\textbf{in parallel}}{
			$w_t^c = w_{t-1}^c - \eta \nabla F(w_{t-1}^c)$\;
		}
		\If{$t|k_1 = 0$ \quad and \quad $t|k_1k_2 \neq 0$}{
			\For{each client $c = 1, 2, \ldots, C$}{
				$w_t^c \gets \texttt{FedSwap}(c, \{w_t^c\}_{c \in C})$\;
			}
		}
		\If{$t|k_1k_2 = 0$}{
			$w_t \gets \texttt{FedAvg}(\{w_t^c\}_{c \in C})$\;
			\For{each client $c = 1, 2, \ldots, C$
				\textbf{in parallel}}{
				$w_t^c \gets w_t$\;
			}
		}
	}
	\SetKwFunction{FedSwap}{FedSwap}
	\SetKwFunction{FedAvg}{FedAvg}
	\SetKwProg{Fn}{Function}{:}{end}
	\Fn{\FedSwap{$c, \{w_t^c\}_{c \in C}$}}{
		$r$ \space represent a random client in \space $C$\;
		$w_t \gets w_t^r$\;
		$w_t^r \gets w_t^c$\;
		\KwRet $w_t$\;
	}
	\Fn{\FedAvg{$\{w_t^c\}_{c \in C}$}}{
		$w_t \gets \sum_{c=1}^C \frac{n_c}{n} w_t^c$\;
		\KwRet $w_t$\;
	}
	\end{latin}
\end{algorithm}
\end{LTR}



\subsection{FedSwapCode}
تست

\section{مشابهت مدل}
تست

\subsection{معیار مشابهت}
تست

\subsection{مشابهت حریصانه}
تست

\subsection{مشابهت بهینه}
تست





